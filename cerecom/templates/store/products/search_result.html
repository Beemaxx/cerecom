{% extends "../base.html" %}
{% load static %}
{% load humanize %}
{% block title %}Home Page{% endblock %}
{% block content %}
<main>

    <section class="text-center container my-4">

                {% if user.is_not_authenticated %}
                <p>
                    <a href="#" class="btn btn-outline-primary my-2">Register or Log In Now</a>
                    <a href="#" class="btn btn-outline-secondary my-2">Browse As Guest</a>
                </p>
                {% endif %}
    </section>

    <div>
        <div class="album py-5 bg-light">
            <div class="container">

                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4">
                    {% if object_list %}
                        {% for product in object_list %}
                    
                        <div class="col">
                            <div class="card shadow-sm">
                            <div class=" mx-3 my-3">
                                <b>Product:</b> 
                                <a class="text-decoration-none text-reset" href={{ product.get_absolute_url}}>{{ product.name }}</a>
                            </div>
                            <div class="border-bottom mx-3"></div>
                            <div class="container-fluid d-flex flex-wrap align-items-center" style="height:200px; width:auto">
                                <!-- Image -->
                            
                                    <img src="{{ product.image.url }}" class="img-fluid" alt="image" style="height:150px; width:auto">
                            
                            </div>
                            <div class="border-top mx-3"></div>
                            <!-- Product Description -->
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                <div class="btn-group">

                                    <!-- View Button -->
                                    <button type="button" class="btn btn-sm btn-outline-secondary">
                                        <a class="text-decoration-none text-reset" type="button" role="button"
                                            href="{{ product.get_absolute_url }}">View</a>
                                    </button>

                                    <!-- Add Button -->
                                    <button id="add-button" data-index="{{ product.id }}"
                                        class="add-button btn btn-outline-secondary mx-1" type="button">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            fill="currentColor" class="bi bi-plus-square" viewBox="0 0 16 16">
                                            <path
                                                d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                                            <path
                                                d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                                        </svg>
                                    </button> 

                                <!-- Product Price-->  
                                </div>
                                <medium class="text-muted">{{product.price}} VND</medium>
                                </div>
                            </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div>The item you look for is not available.</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</main>
<script>
    $(document).on('click', '.add-button', function (e) {
      e.preventDefault();
      $.ajax({
        type: 'POST',
        url: '{% url "cart:cart_add" %}',
        data: {
          productid: $(this).data('index'),
          csrfmiddlewaretoken: "{{csrf_token}}",
          productqty: '1',
          action: 'add',
        },
  
        success: function (json) {
          console.log(json)
          document.getElementById("cart_quanty").innerHTML = json.qty
        },
        error: function (xhr, errmsg, err) {}
      })
    })
  </script>
{% endblock %}